---

copyright:
  years: 2017
lastupdated: "2017-04-13"

---


{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}

# 管理 API
{: #manage_apis}

集成 API 以使其由 API Management 系统进行管理和监视后，可以查看和修改 API 设置。如果尚未集成 API，那么必须完成[通过 {{site.data.keyword.openwhisk_short}} 操作创建 API](manage_openwhisk_apis.html) 中的过程来集成 API。 

要管理 API 的设置，请完成以下步骤：

如果已创建新的 API，并且已在界面中打开该 API，那么可以跳过前三个步骤。

1. 如果要管理的 API 的信息尚未显示，请通过选择 {{site.data.keyword.openwhisk_short}} 服务仪表板上的操作来选择该 API。
2. 根据需要，选择 **API** 选项卡。
3. 根据需要，选择要管理的 API。建立连接后，您可查看和更新以下选项：
    * 总结
    * 定义
    * 共享
    * API Explorer
4. 选择“公开受管 API”滑块以激活该项并公开 API。注：API 未公开时，无法设置某些设置。  

## API 设置摘要
{: #overview_api}

选择 API 时，缺省情况下会选择“摘要”选项卡，该选项卡分为两个部分：
* 属性 - 在“属性”部分中，可以查看以下信息：
    * 关于 API 的基本信息
	* 安全策略
	* 速率限制信息
    * 共享详细信息
* “分析和日志记录”部分 - 在“分析和日志记录”部分中，可以查看以下统计信息：
	* 上一个指定时间间隔内的响应数和平均响应时间
    * 图格式的每分钟 API 调用数
    * “响应日志”表中的最近 100 个响应
	
*响应*图显示了 API 收到的响应数和响应状态细目的情况速览。这可帮助您确定收到的响应中是否绝大多数是错误响应。如果绝大多数是错误响应，可能指示您的流量高于速率设置中允许的流量。您可以通过将鼠标悬停在信息图标上，按响应代码查看响应的数字细目。下面是常见的响应代码：
* 200  正常
* 201  已创建
* 302  已找到
* 304  未修改
* 400  请求错误
* 401  未授权
* 403  已禁止
* 500  内部服务器错误
* 503  服务不可用

“响应日志”表包含最近 100 个响应中每个响应的详细信息。可以通过选择列标题以根据列中的条目对信息排序。您可以使用*搜索响应*栏，在“响应日志”表中搜索特定条目。通过选择事件，或通过选择条目旁选项菜单（三个纵向点）列表中的**查看详细信息**，可查看该事件的更多信息。


## 编辑 API 设置
{: #settings_api}

在**定义**选项卡中，可以更新有关 API 的基本信息。这些信息包括文档、名称和基本 URL。使用“安全性和速率限制”部分可指定调用和时间间隔限制，以确保每秒、每分钟或每小时只发起特定数量的调用。您还可以要求认证才能创建 API 调用，以避免不恰当地使用您的数据，或收集有关 API 的统计信息。

要更改 API 的设置，请完成以下步骤：

1. 在 API Management 仪表板中，单击**定义**选项卡。
2. 可以对 API 命名或更新其名称，然后在“API 信息”部分中导入 API 定义。
3. 在“安全性和速率限制”部分中，可以更新以下策略：
    * 需要 API 密钥 - 指定是否仅当提供正确的 API 密钥时，才能处理 API 调用。缺省设置不需要其他密钥。
    * 安全方法 - 选择了 API 密钥选项时，指定处理 API 是仅需要 API 密钥，还是同时需要 API 密钥和 API 私钥。
    * API 密钥和私钥的位置 - 根据方法的设置，指定 API 安全信息如何包含在调用中。调用名称指定如何识别安全信息。
    * 限制 API 调用速率 - 设置在指定时间间隔内允许的 API 调用数，可选择为每个密钥设置此项。请注意，这将使用脉冲串传输类型的速率限制方法。API 调用平均速率是基于在速率中指定的总时间间隔计算的。如果某个时间间隔内的 API 调用速率超过 API 调用平均速率，那么在速率中指定的时间限制之前，可能会出现拒绝调用的时间段。   
    * OAuth 提供者 - 确保具有正确安全参数的用户可以通过提供者（例如，Google、Facebook、IBM 和 GitHub）的社交登录凭证强制实施 OAuth 来访问 API。
4. 启用 CORS - 跨源请求 (CORS) 支持来自其他域的一些有限请求。
5. 单击**保存**。

## 共享 API
{: #share_api}

您可以与 {{site.data.keyword.Bluemix_notm}} 组织内部或外部的其他用户共享 API。

与 {{site.data.keyword.Bluemix_notm}} 组织内部或外部的其他人共享 API 时，可以为 API 创建密钥。每个受管 API 支持创建 5 个密钥并将其分配给该 API。通过向个人或公司发送唯一密钥，可以跟踪有关该 API 使用情况的一些统计信息。例如，可以跟踪该人员或公司对 API 的调用数。

此外，还可以限制密钥处的调用数，或者禁用某个密钥或限制来自某个密钥的调用。这在测试、均衡工作负载和计算费用期间或用于解决某些安全情况时，会非常有用。  

1. 在 API Management 仪表板中，单击**共享**选项卡。
2. 如果希望 API 可供有权访问 {{site.data.keyword.Bluemix_notm}} 组织的其他人使用，请在“在 {{site.data.keyword.Bluemix_notm}} 组织内共享”区域中，选择**与我的 Bluemix 组织中的所有用户共享 API**。必须选择此项才能生成密钥。
3. 单击**创建 API 密钥**来为 API 创建唯一密钥。这将显示“创建 API 密钥”对话框。API 密钥会自动生成。
4. 使用 API 密钥可通过向用户发送唯一密钥来确定哪个用户在访问该 API。网关可以确定哪个密钥（和客户）在生成调用。
5. 单击密钥旁的**菜单**图标（三个纵向点）可“编辑”或“删除”该 API 密钥。

在“在 {{site.data.keyword.Bluemix_notm}} 组织外部共享”部分中，可以将 API 与没有 {{site.data.keyword.Bluemix_notm}} 帐户的用户共享。此共享方法提供了一个直接链接，用于在 API Explorer 中查看有关 API 的信息。在 API Explorer 视图中，API 包含一个用于运行该 API 的按钮。要请求 API 的链接，请完成以下步骤：

1. 在“在 {{site.data.keyword.Bluemix_notm}} 组织外部共享”部分中，单击**创建 API 密钥**。这将显示“创建 API 密钥”对话框。请注意，用户具有您无法控制的私钥。
2. 为 API 密钥提供唯一名称。
3. 选择**创建密钥**。 
4. 将 API 门户网站链接发送给没有 {{site.data.keyword.Bluemix_notm}} 帐户的客户。该 API 密钥和私钥（如果使用）会包含在链接中，所以您仍可以确定哪个密钥生成了链接。
  
API 文档链接会在 **API Explorer** 选项卡中打开 API。

## 使用 API Explorer 查看和测试
{: #explore_api}

选择 API Explorer 选项卡，以查看从 Swagger 文档生成的 HTML。 

API Explorer 会显示适用于 API 的所有 API 操作和文档。可以在 UI 中查看操作、其描述，并可测试 API。还可以下载 Swagger 文档以复用其内容。

要测试 API，请完成以下步骤：
1. 缺省情况下已选择*示例*。这将显示所选 API 的代码示例。
2. 根据需要，通过从指定语言旁的菜单中选择语言来更改示例格式。 
3. 选择**试试看**。
4. 选择**调用操作**。 

这将显示对请求的响应。   

---

copyright:
  years: 2017
lastupdated: "2017-04-13"

---


{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}

# API の管理
{: #manage_apis}

API が API Management システムによって管理およびモニターされるように API を統合すると、API 設定を表示および変更できるようになります。API を統合していない場合は、『[{{site.data.keyword.openwhisk_short}} アクションからの API の作成](manage_openwhisk_apis.html)』の手順を実行して、API を統合する必要があります。 

API の設定を管理するには、以下のステップを実行します。

新規 API を作成した場合、それが既にインターフェースで開いていれば、最初の 3 つのステップをスキップすることができます。

1. API の情報がまだ表示されていない場合は、{{site.data.keyword.openwhisk_short}} サービスのダッシュボードでアクションを選択して、管理する API を選択します。
2. 必要に応じて、**「API」**タブを選択します。
3. 必要に応じて、管理する API を選択します。接続が確立されると、以下の選択項目を表示および更新できるようになります。
    * サマリー
    * 定義 (Definition)
    * 共有 (Sharing)
    * API エクスプローラー (API Explorer)
4. 「管理対象 API の公開 (Expose Managed API)」スライダーを選択して、それをアクティブにして、API を公開します。注: API が公開されていない場合、一部の設定を行うことができません。  

## API の設定のサマリー
{: #overview_api}

「サマリー」タブは、API を選択するとデフォルトで選択され、以下の 2 つのセクションに分かれています。
* 「プロパティー」 - 「プロパティー」セクションでは、以下の情報を参照できます。
    * API に関する基本情報
	* セキュリティー・ポリシー
	* レート制限情報
    * 共有の詳細
* 「分析とロギング (Analytics and Logging)」セクション - 「分析とロギング (Analytics and Logging)」セクションでは、以下の統計を参照できます。
	* 指定された最後の時間間隔中の応答数および平均応答時間
    * 分当たりの API 呼び出しの回数 (グラフ形式)
    * 「応答ログ (Response Log)」テーブル内の最後の 100 個の応答
	
*「応答」*グラフでは、API が受け取った応答の数および応答の状況の明細を素早く確認できます。これは、過半数のエラー応答を受け取っているかどうかを判断するのに役立ちます。過半数のエラー応答は、レート設定で許可したよりも多くのトラフィックがあることを示す可能性があります。情報アイコンにカーソルを置くことにより、応答コードごとに応答の数値明細を表示できます。一般的な応答コードを以下に示します。
* 200  OK
* 201 Created

* 302  Found
* 304  Not Modified
* 400  Bad Request
* 401  Unauthorized
* 403  Forbidden
* 500  Internal Server Error
* 503  Service Unavailable

「応答ログ (Response Log)」テーブルには、最後の 100 個の応答に関する個別の詳細情報が含まれています。列見出しを選択すると、列内の項目に従って情報をソートすることができます。*「応答の検索 (Search responses)」*バーを使用して、「応答ログ (Response Log)」テーブル内で特定の項目を検索できます。イベントを選択するか、項目の横にあるオプション・メニュー (垂直に並んだ 3 個のドット) のリストで**「詳細を表示」**を選択すると、イベントに関する詳細情報を利用できます。


## API 設定の編集
{: #settings_api}

**「定義 (Definition)」**タブで、API に関する基本情報を更新できます。この情報には、資料、名前、および基本 URL が含まれています。「セキュリティーおよびレート制限 (Security and Rate Limiting)」セクションを使用して、呼び出しおよび間隔の制限を指定することで、1 秒、1 分、または 1 時間ごとに特定の数の呼び出しのみが行われるようにします。データが望ましくない方法で使用されないようにするため、または API に関する統計を収集するために、API 呼び出しを行うときに認証を要求することも可能です。

API の設定を変更するには、以下のステップを実行します。

1. API Management ダッシュボードで、**「定義 (Definition)」**タブをクリックします。
2. 「API 情報 (API Info)」セクションで、API の名前の指定および更新や、API 定義のインポートを行うことができます。
3. 「セキュリティーおよびレート制限 (Security and Rate Limiting)」セクションで、以下のポリシーを更新できます。
    * API キーが必要 (Require API key) - 正しい API キーが提供された場合のみ API 呼び出しを処理できるようにするかどうかを指定します。デフォルト設定では、追加のキーは必要ありません。
    * セキュリティー方式 (Security method) - API キー・オプションが選択されている場合、API を処理するために API キーのみが必要であるか、API キーと API 機密事項の両方が必要であるかを指定します。
    * API キーおよび機密事項のロケーション (Location of the API key and secret) - 方式の設定に応じて、API セキュリティー情報がどのように呼び出しに組み込まれるかを指定します。呼び出し名は、セキュリティー情報の識別方法を指定します。
    * API 呼び出しレートの制限 (Limit API call rate) - 指定された時間間隔中に許可される API 呼び出しの数を、キーごとに設定するオプションを使用して設定します。バースト・タイプのレート制限方式が使用されることに注意してください。API 呼び出しの平均レートは、レートで指定した合計時間間隔にわたって計算されます。間隔中の API 呼び出しのレートが API 呼び出しの平均レートを超えた場合、レートで指定した制限時間まで、呼び出しが拒否される期間が存在する可能性があります。   
    * OAuth プロバイダー (OAuth provider) - 正しいセキュリティー・パラメーターを指定したユーザーが、Google、Facebook、IBM、GitHub のようなプロバイダーのソーシャル・ログイン資格情報を通じて OAuth を適用することにより、API にアクセスできるようにします。
4. CORS の有効化 (Enable CORS) - クロス・オリジン要求 (CORS) により、異なるドメインからの一部の制限された要求が有効になります。
5. **「保存」**をクリックします。

## API の共有
{: #share_api}

自分が属する {{site.data.keyword.Bluemix_notm}} 組織の内部または外部の他のユーザーと API を共有することができます。

{{site.data.keyword.Bluemix_notm}} 組織の内部または外部の他のユーザーと API を共有するときに、API 用のキーを作成できます。管理対象 API ごとに、5 つのキーを作成してその API に割り当てることができます。個人または会社に固有のキーを送信することによって、その API がどのように使用されるかに関する統計を追跡できます。例えば、その個人または会社による API 呼び出しの回数を追跡できます。

キーを無効にしたり、特定のキーからの呼び出しを制限したりすることもできます。これは、テスト、ワークロード・バランシング、収益化の際、あるいはある種のセキュリティー状況に対処するために役立ちます。  

1. API Management ダッシュボードで、**「共有 (Sharing)」**タブをクリックします。
2. {{site.data.keyword.Bluemix_notm}} 組織へのアクセス権限を持つ他のユーザーが API を使用できるようにしたい場合は、「{{site.data.keyword.Bluemix_notm}} 組織内での共有 (Sharing within Bluemix Organization)」領域内で**「Bluemix 組織内のすべてのユーザーと API を共有する (Share API with all users in my Bluemix organization)」**を選択します。キーを生成するには、これを選択する必要があります。
3. **「API キーの作成 (Create API Key)」**をクリックして、API の固有キーを作成します。「API キーの作成 (Create API Key)」ダイアログ・ボックスが表示されます。API キーが自動的に生成されます。
4. ユーザーに固有キーを送信することにより、API キーを使用して、どのユーザーが API にアクセスしているかを判別します。ゲートウェイは、どのキー (および顧客) が呼び出しを生成しているかを判別できます。
5. キーの横にある**「メニュー」**アイコン (垂直に並んだ 3 個のドット) をクリックして、その API キーを編集または削除します。

「{{site.data.keyword.Bluemix_notm}} 組織の外部での共有 (Sharing Outside of Bluemix Organization)」セクションで、{{site.data.keyword.Bluemix_notm}} アカウントを持たないユーザーと API を共有できます。この共有方法では、API エクスプローラー内で API に関する情報を表示するための直接リンクが提供されます。API には、API エクスプローラー・ビューで API を実行するためのボタンが含まれています。API のリンクを要求するには、以下のステップを実行します。

1. 「{{site.data.keyword.Bluemix_notm}} 組織の外部での共有 (Sharing Outside of Bluemix Organization)」セクション内で、**「API キーの作成 (Create API Key)」**をクリックします。「API キーの作成 (Create API Key)」ダイアログ・ボックスが表示されます。ユーザーの機密事項は制御できないことに注意してください。
2. API キーの固有の名前を指定します。
3. **「キーの作成 (Create key)」**を選択します。 
4. API ポータル・リンクを、{{site.data.keyword.Bluemix_notm}} アカウントを持たない顧客に送信します。API キーおよび機密事項 (使用されている場合) がリンクに含まれているため、どのキーがそのリンクを生成したかを引き続き判別できます。
  
API 資料のリンクを使用すると、**「API エクスプローラー (API Explorer)」**タブで API が開きます。

## API エクスプローラーを使用した表示およびテスト
{: #explore_api}

「API エクスプローラー (API Explorer)」タブを選択して、Swagger 文書から生成された html を表示します。 

API エクスプローラーに、API に適用される API アクションおよび資料がすべて表示されます。操作とアクションおよびそれらの説明を表示し、UI から API をテストすることができます。Swagger 文書をダウンロードして、その内容を再利用することもできます。

API をテストするには、以下のステップを実行します。
1. デフォルトでは、*「例」*が選択されています。これにより、選択した API のコードの例が表示されます。
2. 必要に応じて、指定した言語の横にあるメニューから言語を選択して、例のフォーマットを変更します。 
3. **「試行する (Try it)」**を選択します。
4. **「操作の呼び出し (Call operation)」**を選択します。 

要求への応答が表示されます。   

---

copyright:
  years: 2015, 2016

---


{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:screen: .screen}

#アプリの保護
{: #securingapps}

*最終更新日: 2016 年 5 月 9 日*

SSL 証明書をアップロードし、アプリケーションへのアクセスを制限することにより、アプリケーションを保護することができます。
{:shortdesc}

##証明書署名要求の作成
{: #ssl_csr}

{{site.data.keyword.Bluemix}} で許可された SSL 証明書をアップロードするには、その前にご使用のサーバーで証明書署名要求 (CSR) を作成しなければなりません。

CSR というのは、公開鍵と関連情報への署名を要求するために認証局に送信されるメッセージのことです。通常、CSR は PKCS #10 フォーマットになっています。CSR には、共通名、組織、市区町村、都道府県、国、E メールの他に、公開鍵が組み込まれています。SSL 証明書要求は、2048 ビット長の CSR 鍵を使用した場合のみ受理されます。

CSR を有効にするには、CSR の生成時に以下の情報を入力する必要があります。

**国の名前**
  
  国または地域を表す 2 桁のコード。例えば、「US」はアメリカ合衆国を表します。他の国や地域については、CSR を作成する前に、[ISO 国別コードのリスト](https://www.iso.org/obp/ui/#search){:new_window}を調べてください。 
  
**都道府県**

  短縮されていない正式な都道府県の名称。

**地域**

  市区町村の正式名称。
  
**組織**

  その地域で法的に登録された法人もしくは企業の正式名称または個人名。企業の場合は、必ず組織形態名 (Ltd.、Inc.、NV. など) を含めてください。
  
**部門**

  証明書を申請している会社の (経理や営業などの) 部門名。
  
**共通名**

  SSL 証明書の要求先サイトの完全修飾ドメイン名 (FQDN)。
  
CSR の作成方法は、ご使用のオペレーティング・システムによって様々です。以下は、[OpenSSL コマンド・ライン・ツール](http://www.openssl.org/){:new_window}を使用して CSR を作成する方法を示した例です。

```
openssl req -out CSR.csr -new -newkey rsa:2048 -nodes -keyout
    privatekey.key
```

**注:** OpenSSL SHA-512 が実装されるかどうかは、コンパイラーが 64 ビットの整数型をサポートしているかどうかで決まります。SHA-256 の証明書に関して互換性の問題があるアプリケーションでは、SHA-1 オプションを使用してかまいません。

証明書は認証局によって発行され、その認証局によってデジタル署名されています。CSR の作成後は、パブリック認証局に SSL 証明書を生成できます。 

##SSL 証明書のアップロード
{: #ssl_certificate}

セキュリティー・プロトコルを適用して、アプリケーションの通信におけるプライバシーを提供することで、盗聴、不正アクセス、およびメッセージ偽造を防止することができます。

「従量課金 (PAYG)」プランまたは「サブスクリプション」プランが実施されているアカウント所有者がいる {{site.data.keyword.Bluemix_notm}} 内の組織それぞれにつき、4 回の無料証明書アップロードが許可されています。無料トライアル・アカウントを持つアカウント所有者がいる組織のそれぞれにつき、1 回の無料証明書アップロードが許可されています。

証明書をアップロードするには、その前に証明書署名要求を作成する必要があります。『[証明書署名要求の作成](#ssl_csr)』を参照してください。

SSL 証明書を提供するためにカスタム・ドメインを使用するときは、以下の地域エンドポイントを使用して、Bluemix で組織に割り振られた URL 経路を指定します。

  * US-South: secure.us-south.bluemix.net 
  * EU-GB: secure.eu-gb.bluemix.net
  * AU-SYD: secure.au-syd.bluemix.net 


アプリケーションの証明書をアップロードするには、次のようにします。

1. 経路を作成するか、アプリケーションのメニューから**「経路およびアプリ・アクセスの編集」**を選択して既存の経路を編集します。

2. 「経路およびアプリ・アクセスの編集」ダイアログで、**「ドメインの管理」**をクリックします。

3. カスタム・ドメインの場合は、**「証明書のアップロード」**をクリックしてください。

4. 証明書、秘密鍵、およびオプションで中間証明書を参照してアップロードします。また、クライアント証明書の要求を有効にするチェック・ボックスを選択することもできます。クライアント証明書を要求するオプションを有効にする場合は、カスタム・ドメインに対して許可されるユーザー・アクセスを定義するクライアント証明書トラストストア・ファイルをアップロードする必要があります。

  **証明書**
    
    公開鍵を証明書所有者の ID にバインドして証明書の所有者が認証されるようにするデジタル文書。証明書は認証局によって発行され、その認証局によってデジタル署名されています。
    
    証明書は、通常、認証局によって発行および署名されます。ただし、テストおよび開発目的の場合、自己署名証明書を使用することもできます。
    
    {{site.data.keyword.Bluemix_notm}} では以下のタイプの証明書がサポートされています。

	* PEM (pem、.crt、.cer、および .cert)
	* DER (.der または .cer )
	* PKCS #7 (p7b、p7r、spc) 
	  
  **秘密鍵**
  
    対応する公開鍵のみが暗号化解除できるメッセージを暗号化するために使用される算法パターン。秘密鍵は、対応する公開鍵によって暗号化されたメッセージの暗号化解除にも使用されます。秘密鍵はユーザーのシステム上に保持され、パスワードによって保護されています。
    
    {{site.data.keyword.Bluemix_notm}} では以下のタイプの秘密鍵がサポートされています。
    
    * PEM (pem、.key) 
    * PKCS #8 (p8、pk8)
    
    **制限事項:** パスフレーズで保護されている秘密鍵をアップロードすることはできません。
    
  **中間証明書**
  
    特にエンド・エンティティー・サーバー証明書を発行する目的で、トラステッド・ルート認証局 (CA) によって発行される、従属証明書。
その結果として、トラステッド・ルート CA から始まり、中間証明書を経て、組織に発行される SSL 証明書に至る、証明書チェーンが形成されます。
    
    メイン証明書の認証性を検証するには、中間証明書を使用する必要があります。中間証明書は通常、信頼のおける第三者機関から取得します。アプリケーションを実働環境にデプロイする前にテストする際には、中間証明書が不要な場合もあります。
  
  **クライアント証明書の要求の有効化**
  
    このオプションを有効にすると、SSL で保護されたドメインにアクセスしようとするユーザーは、クライアント側の証明書を提供するよう要求されます。例えば、Web ブラウザーでユーザーが SSL で保護されたドメインにアクセスしようとすると、Web ブラウザーは、そのドメインのクライアント証明書を提供するようユーザーにプロンプトを出します。**「クライアント証明書トラストストア」**ファイルのアップロード・オプションを使用して、カスタム・ドメインへのアクセスを許可するクライアント・サイドの証明書を定義します。
  
  **注:** {{site.data.keyword.Bluemix_notm}} ドメイン管理のカスタム証明書機能は、トランスポート層セキュリティー (TLS) プロトコルのサーバー名表示 (SNI) 拡張機能に依存します。このため、カスタム証明書で保護されている {{site.data.keyword.Bluemix_notm}} アプリケーションにアクセスするクライアント・コードは TLS 実装の SNI 拡張機能をサポートする必要があります。詳細については、[RFC
4346 のセクション 7.4.2](http://tools.ietf.org/html/rfc4346#section-7.4.2){:new_window} を参照してください。

  **クライアント証明書トラストストア**
  
  クライアント証明書トラストストアは、アプリケーションへのアクセスを許可するユーザー用のクライアント証明書が入っているファイルです。クライアント証明書を要求するオプションを有効にする場合は、クライアント証明書トラストストア・ファイルをアップロードします。 
  
   {{site.data.keyword.Bluemix_notm}} では以下のタイプの証明書がサポートされています。
    
      * PEM (pem、.crt、.cer、および .cert)
	  * DER (.der または .cer )
      * PKCS #7 (p7b、p7r、spc) 

証明書を削除するか、既存の証明書を新しい証明書に置き換えるには、**「組織の管理」**>**「ドメイン」**>**「証明書の表示」**に移動して、証明書を管理します。
